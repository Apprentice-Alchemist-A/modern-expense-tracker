# エラーログ #003: Google OAuth認証情報設定エラー

## 発生日時
2025-06-22

## エラー概要
新しいSupabaseプロジェクト作成時に、古いGoogle OAuth認証情報（Client IDとClient Secret）を提示してしまい、認証エラーが発生。

## 症状
- Googleログインボタンクリック時に「The OAuth client was not found」エラー
- エラーコード: 401 invalid_client
- 認証フローが完全に失敗

## 根本原因
**私のミス**: 既存プロジェクトのGoogle OAuth認証情報を、新しいSupabaseプロジェクトでも使用できると誤認し、古い認証情報をそのまま提示した。

### 提示した誤った情報
```
Client ID: 659584302978-7bb4n23qsqb95eajhm46kmdl8rucuu0g.apps.googleusercontent.com
Client Secret: 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
```

## 技術的問題点

### 1. 理解不足
- Google OAuth認証情報は**プロジェクト固有**である
- Supabaseプロジェクトが変わった場合、**新しいリダイレクトURI**の設定が必要
- 既存の認証情報に新しいSupabaseプロジェクトのリダイレクトURIを追加する必要がある

### 2. 確認不足
- 新しいSupabaseプロジェクト用のリダイレクトURI設定を確認していなかった
- Google Cloud Platform側の設定更新が必要であることを見落とした

## 正しい対処法

### 1. Google Cloud Console での設定確認
1. **既存のOAuth 2.0クライアント**を確認
2. **承認済みリダイレクトURI**に以下を追加：
   ```
   https://ymbtztejxfgprepzbqtk.supabase.co/auth/v1/callback
   ```

### 2. Supabase側での設定
1. **正しいClient IDとSecret**を確認・取得
2. 新しいSupabaseプロジェクトに設定

### 3. 動作確認
1. 設定保存後、数分待機
2. 認証フローの再テスト

## 学んだ教訓

### 1. 認証情報の取り扱い
- **決して推測や記憶に頼らない**
- 必ず最新の正確な情報を確認してから提示
- プロジェクト変更時は認証設定の見直しが必須

### 2. 設定変更時のチェックリスト
- [ ] 新しいプロジェクトのURL確認
- [ ] リダイレクトURI設定の更新
- [ ] 認証情報の再確認
- [ ] 設定反映の待機時間確保

### 3. エラーレポートの改善
- 認証エラー発生時は、まず**認証情報の正確性**を疑う
- 設定手順書にも**確認ポイント**を明記すべき

## 再発防止策

### 1. 認証設定手順書の改善
- 認証情報は「確認して取得」することを明記
- プロジェクト固有の設定であることを強調

### 2. 設定確認の体系化
- 新しいプロジェクト作成時の認証設定チェックリスト作成
- 段階的な動作確認手順の明確化

### 3. 情報提示の慎重化
- 認証情報や設定値は推測で提示しない
- 必ず最新の正確な情報を確認してから案内

## 今後の対応

### 1. 即座の修正
- 正しいGoogle OAuth設定の確認と案内
- 新しいSupabaseプロジェクトでの認証動作確認

### 2. ドキュメント更新
- 設定手順書の見直しと改善
- 認証トラブルシューティングガイドの追加

## 謝罪
このエラーにより、開発進行に支障をきたし、ユーザーに無駄な作業をさせてしまい申し訳ありませんでした。
今後はより慎重に、正確な情報の確認を徹底いたします。

## 関連ファイル
- `/database/setup-instructions.md` (修正が必要)
- `/lib/supabase/auth.ts`
- `.env.local`